# 2D Game Engine (на Python + pygame)

## Цели проекта (MVP)

Данный проект представляет собой модульный 2D-игровой движок, реализованный на языке Python с использованием библиотеки `pygame`. Ниже перечислены **конкретные цели**, реализация которых необходима для минимально работоспособного состояния движка (MVP).

---

## 1. Игровой цикл

- Реализация основного игрового цикла (`Game.run()`), включающего:
  - обработку входных событий;
  - обновление состояния активной сцены;
  - отрисовку сцены;
  - расчёт времени между кадрами (delta time).
- Настройка целевого FPS с возможностью его ограничения.
- Корректное завершение игры по нажатию клавиши выхода или закрытию окна.

---

## 2. Сцены и управление состояниями

- Абстрактный класс `Scene`, реализующий:
  - метод `update(dt: float)` — обновление логики;
  - метод `draw(surface: pygame.Surface)` — отрисовка;
  - метод `handle_event(event: pygame.event.Event)` — обработка событий.
- Менеджер сцен (`SceneManager`) с возможностью:
  - загрузки новой сцены;
  - возврата к предыдущей;
  - передачи данных между сценами.

---

## 3. Система ввода

- Централизованная система обработки ввода (`InputManager`), включающая:
  - отслеживание состояния клавиш (`is_key_pressed(key: int)` и `was_key_just_pressed(key: int)`);
  - обработку нажатий кнопок мыши;
  - регистрацию и распространение событий ввода по сцене и объектам.

---

## 4. Минимальная аудио-система

- Простая обёртка над `pygame.mixer`, включающая:
  - метод для проигрывания одиночного звука (`play_sound(path: str)`),
  - метод для воспроизведения фоновой музыки (`play_music(path: str, loop: bool)`),
  - возможность остановки/паузы воспроизведения.

---

## 5. Базовая система сущностей

- Класс `Entity` с полями:
  - `position: tuple[float, float]`
  - `velocity: tuple[float, float]`
  - `image: pygame.Surface`
- Поддержка обновления позиции с учётом времени кадра.
- Метод `render(surface: pygame.Surface)` — отрисовка объекта.
- Групповой менеджер (`EntityGroup`) для обновления и отрисовки всех сущностей.
- Поддержка коллизий через `pygame.Rect.colliderect()`.

---

## 6. Загрузка и управление ресурсами

- Менеджер ресурсов (`AssetManager`), обеспечивающий:
  - загрузку и кэширование изображений (`load_image(path: str)`);
  - загрузку и кэширование звуков (`load_sound(path: str)`);
  - загрузку и кэширование шрифтов (`load_font(path: str, size: int)`).
- Обработка ошибок при загрузке ресурсов.
- Исключение повторной загрузки одних и тех же файлов.

---

## 7. Простейшие инструменты UI

- Минимальные виджеты:
  - `UIButton` — прямоугольная кнопка с текстом;
  - `UILabel` — надпись с позиционированием;
- Обработка нажатий на кнопки мышью.
- Отображение UI-элементов поверх сцены с отрисовкой по Z-приоритету.

---

## Примечания

- Все модули реализуются с учётом возможности их замены/наследования.
- Структура проекта будет поддерживать расширение и инкапсуляцию логики по модулям.
- Реализация MVP направлена на то, чтобы с нуля создавать простые 2D-игры без дублирования кода.


## Расширенные цели (необязательные)

Ниже перечислены цели, реализация которых не требуется для MVP, но существенно расширит функциональность движка и улучшит опыт разработки игр.

---

### 1. Модульная архитектура и расширяемость
- Поддержка переопределения внутренних подсистем (например, системы сцены, ввода, отрисовки).
- Внедрение зависимостей через инициализацию (Dependency Injection).
- Возможность регистрации пользовательских расширений через интерфейс `EngineExtension`.

---

### 2. Простая физика
- Поддержка гравитации и простых физических сил.
- Столкновения с разрешением (например, по осям X и Y).
- Расчёт перемещений с учётом ускорения и трения.

---

### 3. Система компонентов (Component-based Entities)
- Добавление к сущностям компонентов поведения (`HealthComponent`, `ColliderComponent` и т.п.).
- Компоненты с собственными методами `update()`, `draw()` и `handle_event()`.
- Возможность создавать объекты, комбинируя наборы компонентов.

---

### 4. Расширенная система UI
- Поддержка макетов (layout) для автоматического размещения элементов.
- Виджеты: переключатели, текстовые поля, слайдеры.
- События наведения курсора и фокусировки (`hover`, `focus`).

---

### 5. Расширенное управление сценами
- Переходы между сценами с анимацией (например, `fade in/out`).
- Стек сцен для реализации вложенных интерфейсов (`PauseScene`, `MenuScene`).
- Сцены с возможностью приостановки и последующего продолжения.

---

### 6. Менеджер пользовательских событий
- Система подписки и публикации событий (`EventBus`).
- Генерация и передача событий между объектами.
- Поддержка отложенных событий и приоритетов.

---

### 7. Сохранение и загрузка состояния игры
- Сериализация и десериализация игрового состояния в JSON.
- Сохранение положения объектов, состояния сцен и настроек.
- Поддержка меню загрузки и сохранения.

---

### 8. Поддержка локализации (i18n)
- Хранение переводов в отдельных JSON-файлах.
- Универсальная функция `tr("menu.play")` для получения текста.
- Динамическое переключение языка без перезапуска игры.

---

### 9. Отладочная панель
- Наэкранный вывод технической информации: FPS, кол-во сущностей, имя активной сцены.
- Встроенная консоль для исполнения команд в рантайме.
- Горячая перезагрузка ресурсов без перезапуска игры.

---

### 10. Адаптивность к разрешению
- Масштабируемая виртуальная камера.
- Автоматическая подгонка UI под разрешение экрана.
- Полноэкранный и оконный режимы с возможностью переключения.

---
